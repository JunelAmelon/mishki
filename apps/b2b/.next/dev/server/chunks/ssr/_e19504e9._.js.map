{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Augustin/Documents/Mishki/packages/shared/src/utils/auth.ts"],"sourcesContent":["export function getRedirectUrl(role: 'b2c' | 'b2b', currentDomain: string): string {\r\n  if (role === 'b2b') {\r\n    // Redirige vers le portail B2B\r\n    if (currentDomain.includes('localhost')) {\r\n      return 'http://localhost:3004/accueil'; // Port B2B en dev\r\n    }\r\n    return 'https://pro.mishki.com/accueil';\r\n  } else {\r\n    // Redirige vers le site B2C\r\n    if (currentDomain.includes('localhost')) {\r\n      return 'http://localhost:3003/'; // Port B2C en dev\r\n    }\r\n    return 'https://www.mishki.com/';\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAO,SAAS,eAAe,IAAmB,EAAE,aAAqB;IACvE,IAAI,SAAS,OAAO;QAClB,+BAA+B;QAC/B,IAAI,cAAc,QAAQ,CAAC,cAAc;YACvC,OAAO,iCAAiC,kBAAkB;QAC5D;QACA,OAAO;IACT,OAAO;QACL,4BAA4B;QAC5B,IAAI,cAAc,QAAQ,CAAC,cAAc;YACvC,OAAO,0BAA0B,kBAAkB;QACrD;QACA,OAAO;IACT;AACF"}},
    {"offset": {"line": 33, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Augustin/Documents/Mishki/packages/shared/src/components/auth/LoginForm.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState } from 'react';\r\nimport Link from 'next/link';\r\nimport Image from 'next/image';\r\nimport { Lock, Mail, AlertCircle } from 'lucide-react';\r\nimport type { LoginProps } from '../../types/auth';\r\nimport { getRedirectUrl } from '../../utils/auth';\r\n\r\nexport function LoginForm({\r\n  onLogin,\r\n  isLoading: externalLoading = false,\r\n  error: externalError,\r\n  redirectUrl,\r\n  logoSrc = '/images/logo-mishki.png',\r\n  title = 'Connexion',\r\n  subtitle = 'Connectez-vous à votre compte',\r\n  showB2BInfo = false,\r\n  primaryColor = '#235730',\r\n  backgroundColor = '#F7F0E0',\r\n}: LoginProps) {\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [internalError, setInternalError] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const error = externalError || internalError;\r\n  const loading = externalLoading || isLoading;\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setInternalError('');\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      // onLogin retourne maintenant l'utilisateur avec son rôle depuis la BDD\r\n      const user = await onLogin(email, password);\r\n      \r\n      // Obtenir l'URL de redirection basée sur le rôle stocké en BDD\r\n      const currentDomain = window.location.hostname;\r\n      const targetUrl = redirectUrl || getRedirectUrl(user.role, currentDomain);\r\n      \r\n      console.log(`Redirection utilisateur ${user.role} (${user.email}) vers:`, targetUrl);\r\n      \r\n      // Redirection vers le dashboard approprié\r\n      window.location.href = targetUrl;\r\n    } catch (err) {\r\n      console.error('Erreur de connexion:', err);\r\n      setInternalError('Email ou mot de passe incorrect');\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className=\"min-h-screen flex items-center justify-center p-4\"\r\n      style={{ backgroundColor }}\r\n    >\r\n      <div className=\"w-full max-w-md\">\r\n        {/* Logo & Title */}\r\n        <div className=\"text-center mb-8\">\r\n          <div\r\n            className=\"inline-flex items-center justify-center mb-2 px-6 py-4 rounded-xl\"\r\n            style={{ backgroundColor: primaryColor }}\r\n          >\r\n            <Image\r\n              src={logoSrc}\r\n              alt=\"Mishki\"\r\n              width={140}\r\n              height={40}\r\n              className=\"object-contain\"\r\n            />\r\n          </div>\r\n          <h1 className=\"text-gray-900 mb-2 text-2xl font-semibold\">{title}</h1>\r\n          <p className=\"text-gray-600\">{subtitle}</p>\r\n        </div>\r\n\r\n        {/* Login Form */}\r\n        <div className=\"bg-white rounded-2xl shadow-xl p-8 border border-gray-100\">\r\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n            {error && (\r\n              <div className=\"flex items-center gap-2 p-4 bg-red-50 text-red-600 rounded-lg\">\r\n                <AlertCircle className=\"w-5 h-5 flex-shrink-0\" />\r\n                <p className=\"text-sm\">{error}</p>\r\n              </div>\r\n            )}\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Email\r\n              </label>\r\n              <div className=\"relative\">\r\n                <Mail className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400\" />\r\n                <input\r\n                  type=\"email\"\r\n                  value={email}\r\n                  onChange={(e) => setEmail(e.target.value)}\r\n                  placeholder=\"votre@email.com\"\r\n                  className=\"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                  required\r\n                  disabled={loading}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Mot de passe\r\n              </label>\r\n              <div className=\"relative\">\r\n                <Lock className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400\" />\r\n                <input\r\n                  type=\"password\"\r\n                  value={password}\r\n                  onChange={(e) => setPassword(e.target.value)}\r\n                  placeholder=\"••••••••\"\r\n                  className=\"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                  required\r\n                  disabled={loading}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex items-center justify-between text-sm\">\r\n              <label className=\"flex items-center gap-2\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  className=\"w-4 h-4 border-gray-300 rounded\"\r\n                  style={{ accentColor: primaryColor }}\r\n                  disabled={loading}\r\n                />\r\n                <span className=\"text-gray-600\">Se souvenir de moi</span>\r\n              </label>\r\n              <a\r\n                href=\"#\"\r\n                className=\"hover:underline\"\r\n                style={{ color: primaryColor }}\r\n              >\r\n                Mot de passe oublié ?\r\n              </a>\r\n            </div>\r\n\r\n            <button\r\n              type=\"submit\"\r\n              disabled={loading}\r\n              className=\"w-full text-white py-3 rounded-lg font-medium transition-all disabled:opacity-50 disabled:cursor-not-allowed hover:opacity-90\"\r\n              style={{ backgroundColor: primaryColor }}\r\n            >\r\n              {loading ? 'Connexion...' : 'Se connecter'}\r\n            </button>\r\n          </form>\r\n\r\n          <div className=\"mt-6 pt-6 border-t border-gray-200 text-center\">\r\n            <p className=\"text-gray-600 text-sm\">\r\n              Pas encore de compte ?{' '}\r\n              <Link\r\n                href=\"/inscription\"\r\n                className=\"font-medium hover:underline\"\r\n                style={{ color: primaryColor }}\r\n              >\r\n                S'inscrire\r\n              </Link>\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Info B2B */}\r\n        {showB2BInfo && (\r\n          <div className=\"mt-6 text-center text-sm text-gray-500\">\r\n            <p>Réservé aux professionnels uniquement</p>\r\n            <p className=\"mt-1\">Validation manuelle sous 24-48h</p>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 398, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Augustin/Documents/Mishki/packages/shared/src/index.ts"],"sourcesContent":["// Types\r\nexport * from './types/auth';\r\n\r\n// Components\r\nexport { LoginForm } from './components/auth/LoginForm';\r\n\r\n// Utils\r\nexport { getRedirectUrl } from './utils/auth';\r\n"],"names":[],"mappings":"AAAA,QAAQ;;AACR;AAEA,aAAa;AACb;AAEA,QAAQ;AACR"}},
    {"offset": {"line": 412, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Augustin/Documents/Mishki/apps/b2b/src/pages/auth/Login.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useAuth } from '../../context/AuthContext';\r\nimport { LoginForm } from '@mishki/shared';\r\n\r\nexport default function Login() {\r\n  const { login } = useAuth();\r\n\r\n  return (\r\n    <LoginForm\r\n      onLogin={login}\r\n      // Ne pas spécifier redirectUrl pour utiliser la redirection automatique\r\n      redirectUrl='/accueil'\r\n      logoSrc=\"/images/logo-mishki.png\"\r\n      title=\"Connexion Espace Professionnel\"\r\n      subtitle=\"Accédez à votre espace professionnel\"\r\n      showB2BInfo={true}\r\n      primaryColor=\"#235730\"\r\n      backgroundColor=\"#F7F0E0\"\r\n    />\r\n  );\r\n}\r\n\r\n// Force SSR pour éviter les erreurs de build avec useAuth\r\nexport async function getServerSideProps() {\r\n  return { props: {} };\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAAA;AAHA;;;;AAKe,SAAS;IACtB,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,wJAAO;IAEzB,qBACE,8OAAC,0KAAS;QACR,SAAS;QACT,wEAAwE;QACxE,aAAY;QACZ,SAAQ;QACR,OAAM;QACN,UAAS;QACT,aAAa;QACb,cAAa;QACb,iBAAgB;;;;;;AAGtB;AAGO,eAAe;IACpB,OAAO;QAAE,OAAO,CAAC;IAAE;AACrB"}},
    {"offset": {"line": 453, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Augustin/Documents/Mishki/apps/b2b/src/app/%28auth%29/login/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport Login from '@/pages/auth/Login';\r\n\r\nexport default function LoginPage() {\r\n  return <Login />;\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAIe,SAAS;IACtB,qBAAO,8OAAC,wJAAK;;;;;AACf"}}]
}